{"paragraphs":[{"text":"%md\n## Using Zeppelin for Data Science Tasks: Data Ingestion, Data Formatting, Exploratory Analysis and Model Building.\n\n\nData Science involves a typical sequence of tasks: aquiring data, cleaning it, analyzing it for relationships, and then building a model. Zeppelin allows you to do all these from one unified interface.","user":"admin","dateUpdated":"2018-11-17T15:37:56+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Using Zeppelin for Data Science Tasks: Data Ingestion, Data Formatting, Exploratory Analysis and Model Building.</h2>\n<p>Data Science involves a typical sequence of tasks: aquiring data, cleaning it, analyzing it for relationships, and then building a model. Zeppelin allows you to do all these from one unified interface.</p>\n"}]},"apps":[],"jobName":"paragraph_1542469076640_-317022672","id":"20150601-165313_1826054142","dateCreated":"2018-11-17T15:37:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27751"},{"text":"%md\n## First, let's load the data into HDFS and make sure we can access it.","user":"admin","dateUpdated":"2018-11-17T15:50:08+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>First, let's load the data into HDFS and make sure we can access it.</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076646_-533510454","id":"20150601-165442_638366896","dateCreated":"2018-11-17T15:37:56+0000","dateStarted":"2018-11-17T15:50:08+0000","dateFinished":"2018-11-17T15:50:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27752"},{"text":"%shell\nwhoami\n\ncurl -sSL -O \"https://www.dropbox.com/s/ggj1robwxpl9vrt/iotdemo-notebook-data.zip\"\nunzip iotdemo-notebook-data.zip\n\nhadoop fs -mkdir -p /user/zeppelin/iotdemo\nhadoop fs -copyFromLocal -f trainingData /user/zeppelin/iotdemo/\nhadoop fs -copyFromLocal -f enrichedEvents /user/zeppelin/iotdemo/\n\nhadoop fs -ls /user/zeppelin/iotdemo/","user":"admin","dateUpdated":"2018-11-17T15:57:30+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"zeppelin\nArchive:  iotdemo-notebook-data.zip\n  inflating: trainingData            \n  inflating: enrichedEvents          \nFound 2 items\n-rw-r--r--   3 zeppelin hdfs      63570 2018-11-17 15:57 /user/zeppelin/iotdemo/enrichedEvents\n-rw-r--r--   3 zeppelin hdfs      33084 2018-11-17 15:57 /user/zeppelin/iotdemo/trainingData\n"}]},"apps":[],"jobName":"paragraph_1542469076646_-1014192310","id":"20150812-230011_789008868","dateCreated":"2018-11-17T15:37:56+0000","dateStarted":"2018-11-17T15:57:30+0000","dateFinished":"2018-11-17T15:57:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27753"},{"text":"%shell\nhadoop fs -cat /user/zeppelin/iotdemo/enrichedEvents | tail -n 10","user":"admin","dateUpdated":"2018-11-17T15:53:14+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Overspeed,\"Y\",\"hours\",45,2773,-90.07,35.68,0,1,1\nLane Departure,\"Y\",\"hours\",45,2773,-90.04,35.19,1,1,0\nNormal,\"Y\",\"hours\",45,2773,-90.68,35.12,1,0,0\nNormal,\"Y\",\"hours\",45,2773,-91.14,34.96,0,0,0\nNormal,\"Y\",\"hours\",45,2773,-91.93,34.81,0,0,0\nNormal,\"Y\",\"hours\",45,2773,-92.31,34.78,0,1,0\nNormal,\"Y\",\"hours\",45,2773,-92.09,34.8,0,0,0\nNormal,\"Y\",\"hours\",45,2773,-91.93,34.81,0,0,0\nNormal,\"Y\",\"hours\",45,2773,-90.68,35.12,0,0,0\nNormal,\"Y\",\"hours\",45,2773,-91.74,34.89,0,0,0\n"}]},"apps":[],"jobName":"paragraph_1542469076646_1613574364","id":"20150601-170021_1937004013","dateCreated":"2018-11-17T15:37:56+0000","dateStarted":"2018-11-17T15:53:14+0000","dateFinished":"2018-11-17T15:53:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27754"},{"text":"%md\n## Let's do some Exploratory Data Analysis so that we have a better grasp on the nature of this data set.","user":"admin","dateUpdated":"2018-11-17T15:51:39+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Let's do some Exploratory Data Analysis so that we have a better grasp on the nature of this data set.</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076647_755447154","id":"20150601-170447_179499526","dateCreated":"2018-11-17T15:37:56+0000","dateStarted":"2018-11-17T15:51:39+0000","dateFinished":"2018-11-17T15:51:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27755"},{"text":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\nimport sqlContext.implicits._\n\nval eventsFile = sc.textFile(\"hdfs:///user/zeppelin/iotdemo/enrichedEvents\")\n\ncase class Event(eventType: String, \n                isCertified: String, \n                paymentScheme: String, \n                hoursDriven: Int, \n                milesDriven: Int, \n                lat: Float, \n                longitude: Float, \n                isFoggy: Int, \n                isRainy: Int, \n                isWindy: Int)\n\nval eventsRDD = eventsFile.map(s => s.split(\",\")).map(\n    s => Event(s(0),        //eventType\n            s(1).replaceAll(\"\\\"\", \"\"),  //isCertified\n            s(2).replaceAll(\"\\\"\", \"\"),  //paymentScheme\n            s(3).toInt,     //hoursDriven\n            s(4).toInt,     //milesDriven\n            s(5).toFloat,   //latitude\n            s(6).toFloat,   //longitude\n            s(7).toInt,     //isFoggy\n            s(8).toInt,     //isRainy\n            s(9).toInt      //isWindy\n        )\n    )\n\n//             scaleEvents(s(3).toInt),     //hoursDriven\n\n\neventsRDD.count\n\neventsRDD.toDF().registerTempTable(\"enrichedEvents\")\n","user":"admin","dateUpdated":"2018-11-17T16:00:28+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there were two deprecation warnings; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@7fdeed08\nimport sqlContext.implicits._\neventsFile: org.apache.spark.rdd.RDD[String] = hdfs:///user/zeppelin/iotdemo/enrichedEvents MapPartitionsRDD[5] at textFile at <console>:19\ndefined class Event\neventsRDD: org.apache.spark.rdd.RDD[Event] = MapPartitionsRDD[7] at map at <console>:32\n"}]},"apps":[],"jobName":"paragraph_1542469076647_1954322963","id":"20150601-171008_2061583323","dateCreated":"2018-11-17T15:37:56+0000","dateStarted":"2018-11-17T16:00:29+0000","dateFinished":"2018-11-17T16:00:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27756","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=1"],"interpreterSettingId":"spark2"}}},{"text":"%sql\n\nselect * from enrichedEvents order by hoursDriven desc limit 10\n","user":"admin","dateUpdated":"2018-11-17T16:00:46+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":true,"keys":[{"name":"eventType","index":0,"aggr":"sum"}],"values":[{"name":"isCertified","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"},"yAxis":{"name":"isCertified","index":1,"aggr":"sum"}},"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"eventType":"string","isCertified":"string","paymentScheme":"string","hoursDriven":"string","milesDriven":"string","lat":"string","longitude":"string","isFoggy":"string","isRainy":"string","isWindy":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\tisCertified\tpaymentScheme\thoursDriven\tmilesDriven\tlat\tlongitude\tisFoggy\tisRainy\tisWindy\nLane Departure\tN\tmiles\t90\t4300\t-91.59\t41.7\t1\t0\t0\nUnsafe tail distance\tN\tmiles\t90\t4300\t-87.67\t41.87\t1\t1\t1\nNormal\tN\tmiles\t90\t4300\t-91.47\t41.74\t0\t0\t0\nNormal\tN\tmiles\t90\t4300\t-89.91\t40.86\t0\t0\t0\nOverspeed\tN\tmiles\t90\t4300\t-93.04\t41.71\t1\t0\t0\nNormal\tN\tmiles\t90\t4300\t-89.52\t40.7\t0\t0\t0\nNormal\tN\tmiles\t90\t4300\t-91.05\t41.72\t0\t0\t1\nNormal\tN\tmiles\t90\t4300\t-90.29\t40.96\t0\t0\t1\nLane Departure\tN\tmiles\t90\t4300\t-88.42\t41.11\t1\t1\t1\nUnsafe following distance\tN\tmiles\t90\t4300\t-88.77\t40.76\t0\t1\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076647_-258953493","id":"20150601-171149_802050103","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27757","dateFinished":"2018-11-17T16:00:46+0000","dateStarted":"2018-11-17T16:00:43+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=2"],"interpreterSettingId":"spark2"}}},{"text":"%md\n## Do certified drivers have less violations?","user":"admin","dateUpdated":"2018-11-17T16:00:59+0000","config":{"tableHide":false,"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Do certified drivers have less violations?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076647_-1537633250","id":"20150601-171831_1908074493","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27758","dateFinished":"2018-11-17T16:00:59+0000","dateStarted":"2018-11-17T16:00:59+0000"},{"text":"%sql\n\nselect eventType, count(*) occurences from enrichedEvents group by eventType","user":"admin","dateUpdated":"2018-11-17T16:01:07+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"eventType","index":0,"aggr":"sum"}],"values":[{"name":"occurences","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\toccurences\nOverspeed\t50\nLane Departure\t37\nUnsafe tail distance\t38\nNormal\t1200\nUnsafe following distance\t34\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076648_-1718363185","id":"20150601-222257_227670657","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27759","dateFinished":"2018-11-17T16:01:06+0000","dateStarted":"2018-11-17T16:01:04+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=3","http://demo.hortonworks.com:4040/jobs/job?id=4","http://demo.hortonworks.com:4040/jobs/job?id=5","http://demo.hortonworks.com:4040/jobs/job?id=6","http://demo.hortonworks.com:4040/jobs/job?id=7"],"interpreterSettingId":"spark2"}}},{"text":"%sql\n\nselect isCertified, count(*) numViolations from enrichedEvents where eventType in (\"Unsafe tail distance\", \"Overspeed\", \"Lane Departure\", \"Unsafe following distance\") group by isCertified","user":"admin","dateUpdated":"2018-11-17T16:01:12+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"isCertified","index":0,"aggr":"sum"}],"values":[{"name":"numViolations","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"isCertified","index":0,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"isCertified\tnumViolations\nY\t97\nN\t62\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076648_-2063543809","id":"20150601-233700_861079238","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27760","dateFinished":"2018-11-17T16:01:11+0000","dateStarted":"2018-11-17T16:01:10+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=8","http://demo.hortonworks.com:4040/jobs/job?id=9","http://demo.hortonworks.com:4040/jobs/job?id=10","http://demo.hortonworks.com:4040/jobs/job?id=11","http://demo.hortonworks.com:4040/jobs/job?id=12"],"interpreterSettingId":"spark2"}}},{"text":"%sql\nselect eventType, isCertified, hoursDriven from enrichedEvents group by eventType, isCertified, hoursDriven","user":"admin","dateUpdated":"2018-11-17T16:01:16+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"hoursDriven","index":2,"aggr":"sum"}],"values":[{"name":"eventType","index":0,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"eventType","index":0,"aggr":"sum"},"yAxis":{"name":"hoursDriven","index":2,"aggr":"sum"},"group":{"name":"hoursDriven","index":2,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"eventType\tisCertified\thoursDriven\nLane Departure\tN\t90\nNormal\tY\t50\nLane Departure\tY\t49\nOverspeed\tN\t70\nOverspeed\tY\t53\nUnsafe following distance\tY\t57\nNormal\tY\t52\nUnsafe following distance\tY\t50\nLane Departure\tY\t58\nLane Departure\tY\t56\nOverspeed\tY\t51\nNormal\tY\t46\nNormal\tY\t60\nUnsafe following distance\tY\t53\nOverspeed\tY\t56\nUnsafe following distance\tN\t70\nUnsafe following distance\tY\t52\nNormal\tY\t58\nNormal\tN\t0\nUnsafe tail distance\tY\t50\nLane Departure\tY\t57\nNormal\tY\t51\nOverspeed\tN\t0\nNormal\tN\t90\nNormal\tN\t70\nLane Departure\tN\t0\nOverspeed\tY\t60\nOverspeed\tY\t45\nNormal\tY\t57\nOverspeed\tY\t49\nOverspeed\tY\t50\nLane Departure\tY\t51\nUnsafe following distance\tY\t45\nUnsafe following distance\tY\t59\nUnsafe following distance\tN\t90\nNormal\tY\t59\nUnsafe tail distance\tY\t53\nLane Departure\tY\t45\nOverspeed\tY\t52\nUnsafe tail distance\tY\t55\nUnsafe tail distance\tY\t57\nNormal\tY\t53\nUnsafe tail distance\tN\t0\nOverspeed\tN\t90\nUnsafe tail distance\tY\t56\nUnsafe tail distance\tY\t52\nNormal\tY\t47\nUnsafe tail distance\tY\t47\nUnsafe following distance\tY\t55\nOverspeed\tY\t59\nUnsafe tail distance\tY\t59\nNormal\tY\t55\nNormal\tY\t56\nUnsafe following distance\tY\t49\nNormal\tY\t54\nUnsafe tail distance\tY\t51\nUnsafe following distance\tN\t0\nOverspeed\tY\t58\nNormal\tY\t48\nUnsafe tail distance\tY\t49\nOverspeed\tY\t47\nNormal\tY\t45\nUnsafe tail distance\tY\t60\nUnsafe tail distance\tN\t90\nLane Departure\tY\t60\nLane Departure\tY\t54\nUnsafe following distance\tY\t58\nNormal\tY\t49\nLane Departure\tY\t46\nOverspeed\tY\t55\nUnsafe following distance\tY\t51\nLane Departure\tN\t70\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076648_1119741123","id":"20150602-005637_838211375","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27761","dateFinished":"2018-11-17T16:01:16+0000","dateStarted":"2018-11-17T16:01:15+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=13","http://demo.hortonworks.com:4040/jobs/job?id=14","http://demo.hortonworks.com:4040/jobs/job?id=15","http://demo.hortonworks.com:4040/jobs/job?id=16","http://demo.hortonworks.com:4040/jobs/job?id=17"],"interpreterSettingId":"spark2"}}},{"text":"%md \n## Does fatigue cause violations?","user":"admin","dateUpdated":"2018-11-17T16:01:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Does fatigue cause violations?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076648_-906627264","id":"20150602-013120_170563003","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27762","dateFinished":"2018-11-17T16:01:20+0000","dateStarted":"2018-11-17T16:01:20+0000"},{"text":"%sql\n\nselect hoursDriven, eventType, count(*) numOccurences from enrichedEvents where eventType not in (\"Normal\") group by hoursDriven, eventType order by hoursDriven\n\n","user":"admin","dateUpdated":"2018-11-17T15:52:56+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":232,"optionOpen":false,"keys":[{"name":"hoursDriven","index":0,"aggr":"sum"}],"values":[{"name":"numOccurences","index":2,"aggr":"count"}],"groups":[],"scatter":{"xAxis":{"name":"hoursDriven","index":0,"aggr":"sum"},"yAxis":{"name":"eventType","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{"eventType":"Normal"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"hoursDriven\teventType\tnumOccurences\n0\tUnsafe tail distance\t12\n0\tOverspeed\t11\n0\tLane Departure\t9\n0\tUnsafe following distance\t8\n45\tOverspeed\t5\n45\tLane Departure\t3\n45\tUnsafe following distance\t1\n46\tLane Departure\t1\n47\tUnsafe tail distance\t2\n47\tOverspeed\t1\n49\tOverspeed\t1\n49\tUnsafe tail distance\t1\n49\tLane Departure\t2\n49\tUnsafe following distance\t4\n50\tOverspeed\t1\n50\tUnsafe following distance\t1\n50\tUnsafe tail distance\t2\n51\tOverspeed\t4\n51\tUnsafe following distance\t5\n51\tLane Departure\t3\n51\tUnsafe tail distance\t2\n52\tUnsafe following distance\t1\n52\tUnsafe tail distance\t2\n52\tOverspeed\t2\n53\tUnsafe following distance\t1\n53\tUnsafe tail distance\t2\n53\tOverspeed\t4\n54\tLane Departure\t2\n55\tUnsafe tail distance\t3\n55\tUnsafe following distance\t5\n55\tOverspeed\t7\n56\tUnsafe tail distance\t2\n56\tOverspeed\t4\n56\tLane Departure\t1\n57\tUnsafe tail distance\t3\n57\tLane Departure\t1\n57\tUnsafe following distance\t2\n58\tLane Departure\t1\n58\tOverspeed\t1\n58\tUnsafe following distance\t1\n59\tUnsafe tail distance\t1\n59\tOverspeed\t1\n59\tUnsafe following distance\t1\n60\tLane Departure\t3\n60\tUnsafe tail distance\t4\n60\tOverspeed\t3\n70\tOverspeed\t1\n70\tLane Departure\t7\n70\tUnsafe following distance\t2\n90\tUnsafe tail distance\t2\n90\tOverspeed\t4\n90\tUnsafe following distance\t2\n90\tLane Departure\t4\n"}]},"apps":[],"jobName":"paragraph_1542469076649_-562822257","id":"20150602-165735_472251841","dateCreated":"2018-11-17T15:37:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27763"},{"text":"%sql\n\nSELECT IF(((`enrichedEvents`.`eventType` = 'Lane Departure') OR (`enrichedEvents`.`eventType` = 'Overspeed') OR (`enrichedEvents`.`eventType` = 'Unsafe following distance') OR (`enrichedEvents`.`eventType` = 'Unsafe tail distance')),'Lane Departure',`enrichedEvents`.`eventType`) AS `grouped_events`, `enrichedEvents`.`hoursDriven` AS `none_hoursdriven_ok`, SUM(1) AS `sum_number_of_records_ok` FROM `enrichedEvents` `enrichedEvents` GROUP BY IF(((`enrichedEvents`.`eventType` = 'Lane Departure') OR (`enrichedEvents`.`eventType` = 'Overspeed') OR (`enrichedEvents`.`eventType` = 'Unsafe following distance') OR (`enrichedEvents`.`eventType` = 'Unsafe tail distance')),'Lane Departure',`enrichedEvents`.`eventType`), `enrichedEvents`.`hoursDriven`\n","user":"admin","dateUpdated":"2018-11-17T16:01:28+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":302,"optionOpen":false,"keys":[{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}],"values":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"groups":[{"name":"grouped_events","index":0,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_hoursdriven_ok\tsum_number_of_records_ok\nNormal\t57\t108\nNormal\t51\t166\nNormal\t45\t97\nNormal\t46\t13\nLane Departure\t57\t6\nLane Departure\t52\t5\nLane Departure\t90\t12\nLane Departure\t54\t2\nLane Departure\t49\t8\nLane Departure\t0\t40\nLane Departure\t47\t3\nNormal\t58\t31\nNormal\t90\t20\nLane Departure\t60\t10\nNormal\t48\t5\nNormal\t53\t88\nLane Departure\t51\t14\nNormal\t49\t61\nNormal\t60\t137\nNormal\t55\t94\nLane Departure\t55\t15\nLane Departure\t58\t3\nNormal\t59\t48\nNormal\t0\t35\nLane Departure\t53\t7\nNormal\t54\t54\nLane Departure\t56\t7\nNormal\t52\t48\nLane Departure\t50\t4\nNormal\t70\t57\nNormal\t50\t53\nNormal\t56\t73\nLane Departure\t70\t10\nLane Departure\t46\t1\nLane Departure\t59\t3\nNormal\t47\t12\nLane Departure\t45\t9\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076649_1775159156","id":"20150602-165744_1812152248","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27764","dateFinished":"2018-11-17T16:01:28+0000","dateStarted":"2018-11-17T16:01:27+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=18","http://demo.hortonworks.com:4040/jobs/job?id=19","http://demo.hortonworks.com:4040/jobs/job?id=20","http://demo.hortonworks.com:4040/jobs/job?id=21","http://demo.hortonworks.com:4040/jobs/job?id=22"],"interpreterSettingId":"spark2"}}},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isCertified AS num_certified, SUM(1) AS sum_number_of_records FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isCertified","user":"admin","dateUpdated":"2018-11-17T16:01:33+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records","index":2,"aggr":"sum"}],"groups":[{"name":"num_certified","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"num_certified","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnum_certified\tsum_number_of_records\nNormal\tY\t1088\nLane Departure\tN\t62\nLane Departure\tY\t97\nNormal\tN\t112\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076649_-916863757","id":"20150602-183904_189812181","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27765","dateFinished":"2018-11-17T16:01:32+0000","dateStarted":"2018-11-17T16:01:31+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=23","http://demo.hortonworks.com:4040/jobs/job?id=24","http://demo.hortonworks.com:4040/jobs/job?id=25","http://demo.hortonworks.com:4040/jobs/job?id=26","http://demo.hortonworks.com:4040/jobs/job?id=27"],"interpreterSettingId":"spark2"}}},{"text":"%md\n## What's the impact of fog on driving?","user":"admin","dateUpdated":"2018-11-17T16:01:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_hoursdriven_ok","index":1,"aggr":"sum"}}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>What's the impact of fog on driving?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076649_-65795385","id":"20150602-185736_1176020804","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27766","dateFinished":"2018-11-17T16:01:38+0000","dateStarted":"2018-11-17T16:01:38+0000"},{"text":"%sql\n\n\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isFoggy AS `num_foggy`, SUM(1) AS sum_number_of_records FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isFoggy","user":"admin","dateUpdated":"2018-11-17T16:01:44+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records","index":2,"aggr":"sum"}],"groups":[{"name":"num_foggy","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"num_foggy","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnum_foggy\tsum_number_of_records\nLane Departure\t1\t111\nLane Departure\t0\t48\nNormal\t0\t1036\nNormal\t1\t164\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076649_153632852","id":"20150603-005352_2051370027","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27767","dateFinished":"2018-11-17T16:01:43+0000","dateStarted":"2018-11-17T16:01:43+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=28","http://demo.hortonworks.com:4040/jobs/job?id=29","http://demo.hortonworks.com:4040/jobs/job?id=30","http://demo.hortonworks.com:4040/jobs/job?id=31","http://demo.hortonworks.com:4040/jobs/job?id=32"],"interpreterSettingId":"spark2"}}},{"text":"%md \n##What's the impact of rain on driving?","user":"admin","dateUpdated":"2018-11-17T16:01:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>What's the impact of rain on driving?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076650_-837429000","id":"20150603-082821_53714184","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27768","dateFinished":"2018-11-17T16:01:51+0000","dateStarted":"2018-11-17T16:01:51+0000"},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isRainy AS `none_rainy_ok`, SUM(1) AS `sum_number_of_records_ok` FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isRainy","user":"admin","dateUpdated":"2018-11-17T16:01:56+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"groups":[{"name":"none_rainy_ok","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_rainy_ok","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_rainy_ok\tsum_number_of_records_ok\nLane Departure\t1\t96\nLane Departure\t0\t63\nNormal\t0\t1038\nNormal\t1\t162\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076650_1253778758","id":"20150603-161651_886203277","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27769","dateFinished":"2018-11-17T16:01:55+0000","dateStarted":"2018-11-17T16:01:55+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=33","http://demo.hortonworks.com:4040/jobs/job?id=34","http://demo.hortonworks.com:4040/jobs/job?id=35","http://demo.hortonworks.com:4040/jobs/job?id=36","http://demo.hortonworks.com:4040/jobs/job?id=37"],"interpreterSettingId":"spark2"}}},{"text":"%md\n\n## What's the impact of wind on driving?","user":"admin","dateUpdated":"2018-11-17T16:02:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>What's the impact of wind on driving?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076650_2144921649","id":"20150603-085134_652083579","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27770","dateFinished":"2018-11-17T16:02:01+0000","dateStarted":"2018-11-17T16:02:01+0000"},{"text":"%sql\n\nSELECT IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType) AS `grouped_events`, isWindy AS `none_windy_ok`, SUM(1) AS `sum_number_of_records_ok` FROM enrichedEvents enrichedEvents GROUP BY IF(((eventType = 'Lane Departure') OR (eventType = 'Overspeed') OR (eventType = 'Unsafe following distance') OR (eventType = 'Unsafe tail distance')),'Lane Departure', eventType), isWindy","user":"admin","dateUpdated":"2018-11-17T16:02:07+0000","config":{"tableHide":false,"editorSetting":{"language":"text","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/text","editorHide":false,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"grouped_events","index":0,"aggr":"sum"}],"values":[{"name":"sum_number_of_records_ok","index":2,"aggr":"sum"}],"groups":[{"name":"none_windy_ok","index":1,"aggr":"sum"}],"scatter":{"xAxis":{"name":"grouped_events","index":0,"aggr":"sum"},"yAxis":{"name":"none_windy_ok","index":1,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"grouped_events\tnone_windy_ok\tsum_number_of_records_ok\nLane Departure\t1\t51\nLane Departure\t0\t108\nNormal\t0\t891\nNormal\t1\t309\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076650_-462806055","id":"20150603-085501_2095284086","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27771","dateFinished":"2018-11-17T16:02:07+0000","dateStarted":"2018-11-17T16:02:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=38","http://demo.hortonworks.com:4040/jobs/job?id=39","http://demo.hortonworks.com:4040/jobs/job?id=40","http://demo.hortonworks.com:4040/jobs/job?id=41","http://demo.hortonworks.com:4040/jobs/job?id=42"],"interpreterSettingId":"spark2"}}},{"text":"%md\n\n## Does location have any impact on incidents?","user":"admin","dateUpdated":"2018-11-17T16:02:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Does location have any impact on incidents?</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076651_533512294","id":"20150612-103100_302525333","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27772","dateFinished":"2018-11-17T16:02:10+0000","dateStarted":"2018-11-17T16:02:10+0000"},{"text":"%sql\n\nselect lat, longitude, eventType, isFoggy from enrichedEvents where eventType not in ('Normal') and isFoggy = 1 group by lat, longitude, eventType, isFoggy ","user":"admin","dateUpdated":"2018-11-17T16:02:41+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":[{"graph":{"mode":"scatterChart","height":288,"optionOpen":true,"keys":[{"name":"eventType","index":2,"aggr":"sum"}],"values":[{"name":"long","index":1,"aggr":"sum"}],"groups":[{"name":"eventType","index":2,"aggr":"sum"}],"scatter":{"xAxis":{"name":"long","index":1,"aggr":"sum"},"yAxis":{"name":"lat","index":0,"aggr":"sum"},"group":{"name":"isFoggy","index":3,"aggr":"sum"}}}}],"enabled":true,"fontSize":9},"settings":{"params":{"eventType":"Unsafe tail distance"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"lat\tlongitude\teventType\tisFoggy\n-91.33\t38.87\tUnsafe following distance\t1\n-89.52\t40.7\tOverspeed\t1\n-93.04\t41.71\tOverspeed\t1\n-91.33\t38.87\tUnsafe tail distance\t1\n-95.99\t36.17\tOverspeed\t1\n-88.42\t41.11\tLane Departure\t1\n-90.79\t38.83\tOverspeed\t1\n-88.42\t41.11\tUnsafe following distance\t1\n-90.52\t39.71\tOverspeed\t1\n-94.38\t38.67\tUnsafe tail distance\t1\n-89.91\t40.86\tUnsafe tail distance\t1\n-94.57\t35.37\tOverspeed\t1\n-95.5\t36.37\tLane Departure\t1\n-94.28\t39.53\tUnsafe tail distance\t1\n-89.52\t40.7\tUnsafe tail distance\t1\n-89.63\t39.84\tOverspeed\t1\n-87.67\t41.87\tOverspeed\t1\n-90.64\t41.56\tOverspeed\t1\n-89.03\t41.92\tUnsafe following distance\t1\n-90.04\t35.19\tUnsafe tail distance\t1\n-89.17\t40.38\tUnsafe following distance\t1\n-94.23\t37.09\tLane Departure\t1\n-90.04\t35.19\tOverspeed\t1\n-90.04\t35.19\tUnsafe following distance\t1\n-91.78\t42.23\tUnsafe following distance\t1\n-88.07\t41.48\tLane Departure\t1\n-90.79\t38.83\tUnsafe tail distance\t1\n-94.38\t38.99\tOverspeed\t1\n-94.88\t35.47\tOverspeed\t1\n-89.71\t37.47\tUnsafe tail distance\t1\n-89.03\t41.92\tLane Departure\t1\n-94.28\t39.53\tOverspeed\t1\n-89.54\t36.84\tOverspeed\t1\n-89.52\t40.7\tUnsafe following distance\t1\n-88.02\t42.04\tLane Departure\t1\n-90.79\t38.83\tUnsafe following distance\t1\n-90.04\t35.19\tLane Departure\t1\n-88.96\t42.25\tUnsafe tail distance\t1\n-90.34\t38.58\tOverspeed\t1\n-89.63\t39.84\tUnsafe tail distance\t1\n-91.18\t38.22\tUnsafe following distance\t1\n-91.33\t38.87\tLane Departure\t1\n-89.91\t40.86\tOverspeed\t1\n-92.31\t34.78\tOverspeed\t1\n-88.77\t40.76\tUnsafe tail distance\t1\n-90.64\t41.56\tUnsafe tail distance\t1\n-94.38\t38.67\tOverspeed\t1\n-91.59\t41.7\tLane Departure\t1\n-94.58\t37.03\tUnsafe following distance\t1\n-90.82\t41.66\tOverspeed\t1\n-94.23\t37.09\tUnsafe following distance\t1\n-95.99\t36.17\tUnsafe following distance\t1\n-90.64\t41.56\tLane Departure\t1\n-91.94\t41.71\tOverspeed\t1\n-94.57\t35.37\tUnsafe following distance\t1\n-91.94\t41.71\tUnsafe following distance\t1\n-89.03\t41.92\tOverspeed\t1\n-89.03\t41.92\tUnsafe tail distance\t1\n-91.18\t38.22\tLane Departure\t1\n-89.8\t35.94\tLane Departure\t1\n-89.91\t40.86\tLane Departure\t1\n-90.37\t35.21\tLane Departure\t1\n-89.52\t40.7\tLane Departure\t1\n-94.88\t35.47\tLane Departure\t1\n-94.57\t35.37\tLane Departure\t1\n-89.74\t39.1\tUnsafe tail distance\t1\n-92.99\t37.34\tOverspeed\t1\n-88.96\t42.25\tUnsafe following distance\t1\n-88.07\t41.48\tUnsafe tail distance\t1\n-92.31\t34.78\tUnsafe tail distance\t1\n-88.07\t41.48\tOverspeed\t1\n-87.67\t41.87\tUnsafe tail distance\t1\n-94.57\t35.37\tUnsafe tail distance\t1\n-92.4\t41.78\tLane Departure\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1542469076651_1183343367","id":"20150603-182617_1986095422","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27773","dateFinished":"2018-11-17T16:02:42+0000","dateStarted":"2018-11-17T16:02:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=43","http://demo.hortonworks.com:4040/jobs/job?id=44","http://demo.hortonworks.com:4040/jobs/job?id=45","http://demo.hortonworks.com:4040/jobs/job?id=46","http://demo.hortonworks.com:4040/jobs/job?id=47"],"interpreterSettingId":"spark2"}}},{"text":"%md\n\n## Done with data analysis, let's build a regression model to predict violations","user":"admin","dateUpdated":"2018-11-17T16:02:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Done with data analysis, let's build a regression model to predict violations</h2>\n"}]},"apps":[],"jobName":"paragraph_1542469076651_-839356268","id":"20150612-103159_813648130","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27774","dateFinished":"2018-11-17T16:02:48+0000","dateStarted":"2018-11-17T16:02:48+0000"},{"text":"import org.apache.spark.mllib.util.MLUtils;\nimport org.apache.spark.mllib.optimization;\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD;\nimport org.apache.spark.mllib.optimization.SquaredL2Updater;\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics;\n\n    val examples = MLUtils.loadLabeledPoints(sc,\"hdfs:///user/zeppelin/iotdemo/trainingData\").cache()\n\n    val splits = examples.randomSplit(Array(0.8, 0.2))\n    val training = splits(0).cache()\n    val test = splits(1).cache()\n\n    val numTraining = training.count()\n    val numTest = test.count()\n    println(s\"Training: $numTraining, test: $numTest.\")\n    \n    val updater = new SquaredL2Updater()\n    \n     val model = {\n        val algorithm = new LogisticRegressionWithSGD()\n        algorithm.optimizer.setNumIterations(200).setStepSize(1.0).setUpdater(updater).setRegParam(0.1)\n        algorithm.run(training).clearThreshold()\n     }   \n        \n    val rprediction = model.predict(test.map(_.features))\n    val rpredictionAndLabel = rprediction.zip(test.map(_.label))\n    val rmetrics = new BinaryClassificationMetrics(rpredictionAndLabel)\n\n    println(\"\\n\");\n    println(\"Certification Weight \" + model.weights(0))\n    println(\"Wage Plan Weight \" + model.weights(1))\n    println(\"Fatigue by Hours Weight \" + model.weights(2))\n    println(\"Fatigue by Miles Weight \" + model.weights(3))\n    println(\"Foggy weather Weight \" + model.weights(4))\n    println(\"Rainy weather Weight \" + model.weights(5))\n    println(\"Windy weather Weight \" + model.weights(6))\n    println(\"\\n\")\n    println(\"Intercept \" + model.intercept)\n    println(s\"Test areaUnderPR = ${rmetrics.areaUnderPR()}.\")\n    println(s\"Test areaUnderROC = ${rmetrics.areaUnderROC()}.\")","user":"admin","dateUpdated":"2018-11-17T16:05:38+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nTraining: 1086, test: 273.\n\n\nCertification Weight 0.0\nWage Plan Weight 0.0\nFatigue by Hours Weight -1.031251197514398\nFatigue by Miles Weight -0.5126728032933805\nFoggy weather Weight 0.07728662731670968\nRainy weather Weight 0.009152632694278408\nWindy weather Weight -0.397724787817611\n\n\nIntercept 0.0\nTest areaUnderPR = 0.3385991182825161.\nTest areaUnderROC = 0.563265306122449.\nimport org.apache.spark.mllib.util.MLUtils\nimport org.apache.spark.mllib.optimization\nimport org.apache.spark.mllib.classification.LogisticRegressionWithSGD\nimport org.apache.spark.mllib.optimization.SquaredL2Updater\nimport org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nexamples: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[97] at map at MLUtils.scala:216\nsplits: Array[org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint]] = Array(MapPartitionsRDD[98] at randomSplit at <console>:38, MapPartitionsRDD[99] at randomSplit at <console>:38)\ntraining: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] = MapPartitionsRDD[98] at randomSplit at <console>:38\ntest: org.apache.spark.rdd.RDD[org.apa..."}]},"apps":[],"jobName":"paragraph_1542469076651_1793476239","id":"20150603-085258_1341928479","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27775","dateFinished":"2018-11-17T16:05:42+0000","dateStarted":"2018-11-17T16:05:38+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://demo.hortonworks.com:4040/jobs/job?id=48","http://demo.hortonworks.com:4040/jobs/job?id=49","http://demo.hortonworks.com:4040/jobs/job?id=50","http://demo.hortonworks.com:4040/jobs/job?id=51","http://demo.hortonworks.com:4040/jobs/job?id=52","http://demo.hortonworks.com:4040/jobs/job?id=53","http://demo.hortonworks.com:4040/jobs/job?id=54","http://demo.hortonworks.com:4040/jobs/job?id=55","http://demo.hortonworks.com:4040/jobs/job?id=56","http://demo.hortonworks.com:4040/jobs/job?id=57","http://demo.hortonworks.com:4040/jobs/job?id=58","http://demo.hortonworks.com:4040/jobs/job?id=59","http://demo.hortonworks.com:4040/jobs/job?id=60","http://demo.hortonworks.com:4040/jobs/job?id=61","http://demo.hortonworks.com:4040/jobs/job?id=62","http://demo.hortonworks.com:4040/jobs/job?id=63","http://demo.hortonworks.com:4040/jobs/job?id=64","http://demo.hortonworks.com:4040/jobs/job?id=65","http://demo.hortonworks.com:4040/jobs/job?id=66","http://demo.hortonworks.com:4040/jobs/job?id=67","http://demo.hortonworks.com:4040/jobs/job?id=68","http://demo.hortonworks.com:4040/jobs/job?id=69","http://demo.hortonworks.com:4040/jobs/job?id=70","http://demo.hortonworks.com:4040/jobs/job?id=71","http://demo.hortonworks.com:4040/jobs/job?id=72","http://demo.hortonworks.com:4040/jobs/job?id=73","http://demo.hortonworks.com:4040/jobs/job?id=74","http://demo.hortonworks.com:4040/jobs/job?id=75","http://demo.hortonworks.com:4040/jobs/job?id=76","http://demo.hortonworks.com:4040/jobs/job?id=77","http://demo.hortonworks.com:4040/jobs/job?id=78","http://demo.hortonworks.com:4040/jobs/job?id=79","http://demo.hortonworks.com:4040/jobs/job?id=80","http://demo.hortonworks.com:4040/jobs/job?id=81","http://demo.hortonworks.com:4040/jobs/job?id=82","http://demo.hortonworks.com:4040/jobs/job?id=83","http://demo.hortonworks.com:4040/jobs/job?id=84","http://demo.hortonworks.com:4040/jobs/job?id=85","http://demo.hortonworks.com:4040/jobs/job?id=86","http://demo.hortonworks.com:4040/jobs/job?id=87","http://demo.hortonworks.com:4040/jobs/job?id=88","http://demo.hortonworks.com:4040/jobs/job?id=89","http://demo.hortonworks.com:4040/jobs/job?id=90","http://demo.hortonworks.com:4040/jobs/job?id=91","http://demo.hortonworks.com:4040/jobs/job?id=92","http://demo.hortonworks.com:4040/jobs/job?id=93","http://demo.hortonworks.com:4040/jobs/job?id=94","http://demo.hortonworks.com:4040/jobs/job?id=95","http://demo.hortonworks.com:4040/jobs/job?id=96","http://demo.hortonworks.com:4040/jobs/job?id=97","http://demo.hortonworks.com:4040/jobs/job?id=98","http://demo.hortonworks.com:4040/jobs/job?id=99","http://demo.hortonworks.com:4040/jobs/job?id=100","http://demo.hortonworks.com:4040/jobs/job?id=101","http://demo.hortonworks.com:4040/jobs/job?id=102","http://demo.hortonworks.com:4040/jobs/job?id=103","http://demo.hortonworks.com:4040/jobs/job?id=104","http://demo.hortonworks.com:4040/jobs/job?id=105","http://demo.hortonworks.com:4040/jobs/job?id=106","http://demo.hortonworks.com:4040/jobs/job?id=107","http://demo.hortonworks.com:4040/jobs/job?id=108","http://demo.hortonworks.com:4040/jobs/job?id=109","http://demo.hortonworks.com:4040/jobs/job?id=110","http://demo.hortonworks.com:4040/jobs/job?id=111","http://demo.hortonworks.com:4040/jobs/job?id=112","http://demo.hortonworks.com:4040/jobs/job?id=113","http://demo.hortonworks.com:4040/jobs/job?id=114","http://demo.hortonworks.com:4040/jobs/job?id=115","http://demo.hortonworks.com:4040/jobs/job?id=116","http://demo.hortonworks.com:4040/jobs/job?id=117","http://demo.hortonworks.com:4040/jobs/job?id=118","http://demo.hortonworks.com:4040/jobs/job?id=119","http://demo.hortonworks.com:4040/jobs/job?id=120","http://demo.hortonworks.com:4040/jobs/job?id=121","http://demo.hortonworks.com:4040/jobs/job?id=122","http://demo.hortonworks.com:4040/jobs/job?id=123","http://demo.hortonworks.com:4040/jobs/job?id=124","http://demo.hortonworks.com:4040/jobs/job?id=125","http://demo.hortonworks.com:4040/jobs/job?id=126","http://demo.hortonworks.com:4040/jobs/job?id=127","http://demo.hortonworks.com:4040/jobs/job?id=128","http://demo.hortonworks.com:4040/jobs/job?id=129","http://demo.hortonworks.com:4040/jobs/job?id=130","http://demo.hortonworks.com:4040/jobs/job?id=131","http://demo.hortonworks.com:4040/jobs/job?id=132","http://demo.hortonworks.com:4040/jobs/job?id=133","http://demo.hortonworks.com:4040/jobs/job?id=134","http://demo.hortonworks.com:4040/jobs/job?id=135","http://demo.hortonworks.com:4040/jobs/job?id=136","http://demo.hortonworks.com:4040/jobs/job?id=137","http://demo.hortonworks.com:4040/jobs/job?id=138","http://demo.hortonworks.com:4040/jobs/job?id=139","http://demo.hortonworks.com:4040/jobs/job?id=140","http://demo.hortonworks.com:4040/jobs/job?id=141","http://demo.hortonworks.com:4040/jobs/job?id=142","http://demo.hortonworks.com:4040/jobs/job?id=143","http://demo.hortonworks.com:4040/jobs/job?id=144","http://demo.hortonworks.com:4040/jobs/job?id=145"],"interpreterSettingId":"spark2"}}},{"text":"model.toPMML(\"iot.xml\")","user":"admin","dateUpdated":"2018-11-17T16:08:19+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542469076651_7432310","id":"20150604-204831_1742166011","dateCreated":"2018-11-17T15:37:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27776","dateFinished":"2018-11-17T16:08:20+0000","dateStarted":"2018-11-17T16:08:19+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"admin","dateUpdated":"2018-11-17T15:37:56+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1542469076652_695625302","id":"20150812-223911_1229239436","dateCreated":"2018-11-17T15:37:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:27777"}],"name":"Demos / IoT / Trucking Data Analysis","id":"2DWAK8TRG","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark2:shared_process":[],"shell:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}